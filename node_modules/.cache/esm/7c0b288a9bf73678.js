let CustomErrorHandler,JwtService;_9bf‍.x([["default",()=>_9bf‍.o]]);_9bf‍.w("../services/CustomErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_9bf‍.w("../services/JwtService",[["default",["JwtService"],function(v){JwtService=v}]]);

const auth = async (req ,res , next)=>{
// get the header

let authHeader = req.headers.authorization;
 
if(!authHeader)
{
    return next(CustomErrorHandler.unAuthorized())
}

const token =  authHeader.split(' ')[1]

try{
 const {_id , role} =  await JwtService.verify(token)
 req.user = {}
 req.user._id = _id
 req.user.role = role

  next()

}catch(err){
    return next(CustomErrorHandler.unAuthorized())
}

}
_9bf‍.d(auth);